worker_processes auto;
error_log /var/log/openresty/error.log;
pid logs/nginx.pid;

events {
    worker_connections 1024;
}

http {
    include       mime.types;
    default_type  application/octet-stream;

    sendfile        on;
    tcp_nopush      on;
    keepalive_timeout 65;

    client_max_body_size 10M;

    # Access log
    access_log /var/log/openresty/access.log;

    # Gzip
    gzip on;

    # SSL
    ssl_protocols TLSv1 TLSv1.1 TLSv1.2 TLSv1.3;
    ssl_prefer_server_ciphers on;

    # Upstream backends
    upstream minio_s3 {
        server 127.0.0.1:9000;
    }

    upstream minio_console {
        server 127.0.0.1:9001;
    }

    upstream keycloak {
        server 127.0.0.1:8080;
    }

    upstream ecos {
        server 127.0.0.1:8000;
    }

    upstream opa {
        server 127.0.0.1:8181;
    }

    include /etc/openresty/conf.d/*.conf;
}